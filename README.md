# Ideazoop – Idea-to-Product Platform (MVP)

Collaborative web application that helps **Idea Owners** turn raw ideas into validated, review-ready proposals while giving **Admins** a lightweight workflow to approve or reject them.

*Stack – Next.js 14 • TypeScript • Tailwind CSS + shadcn-ui • Supabase (Postgres + Auth + Realtime) • OpenAI API • Vercel*

---

## Table of Contents
1. [Key Features](#key-features)
2. [Solution Architecture](#solution-architecture)
3. [Monorepo Layout](#monorepo-layout)
4. [Getting Started](#getting-started)
5. [Database & Supabase](#database--supabase)
6. [Development Workflow](#development-workflow)
7. [Quality & CI/CD](#quality--cicd)
8. [Deployment (GitHub → Vercel)](#deployment-github--vercel)
9. [Contributing](#contributing)
10. [License](#license)

---

## Key Features
| Epic | Description |
|------|-------------|
| Authentication | Google sign-in via Supabase Auth; automatic profile creation trigger. |
| Idea Workflow | Draft → Submitted → Approved/Rejected; enforced with RLS & API guards. |
| Comments & Notifications | Real-time threaded comments; inbox powered by Supabase Realtime + DB triggers. |
| Admin Review | Admin dashboard to approve/reject with mandatory comment. |
| Dashboard | Status counters & filters (draft, submitted, approved, rejected). |
| AI Assistant | `/api/ai/idea-helper` endpoint improves copy & autogenerates tags using OpenAI (5 calls/day). |
| RBAC & RLS | Owners manage their content, Admins moderate all; enforced directly in Postgres. |
| Mobile-first UI | shadcn-ui components, responsive design. |
| Testing & CI | Vitest unit tests, Playwright e2e (draft → approve), GitHub Actions + Vercel previews. |

---

## Solution Architecture

### High-level Diagram
```
Browser ──> Next.js (App Router, RSC)
             │     ▲         │
             ▼     │ Supabase Auth
OpenAI  <─ Edge Function          Realtime (WS)
             ▼
Supabase Postgres ←→ Row-Level Security
```

### Front-end
* **Next.js 14** App Router, Server Components, Turbopack (`next dev`).
* **shadcn-ui** + **Tailwind CSS** – accessible UI primitives.
* **React Query** for client caching of Supabase calls & RPCs.

### Back-end / Data
* **Supabase Cloud** – Postgres 15, Auth, Realtime, Storage.
* **RLS** policies (see `database/migrations/001_initial_schema.sql`).
* **Edge Runtime** route for OpenAI requests (isolated API key).

---

## Monorepo Layout
```
.
├── database/            # SQL migrations (Supabase CLI)
│   └── migrations/001_initial_schema.sql
├── src/
│   ├── app/             # Next.js routes (+layout, +page)
│   ├── components/ui/   # shadcn-ui components (button, card, …)
│   └── lib/
│       ├── supabase.ts  # browser/server/admin clients
│       ├── utils.ts     # helper utilities
│       └── database.types.ts  # generated by Supabase CLI
├── public/
├── .env.local.example   # environment template
├── next.config.ts
└── package.json
```

---

## Getting Started

### Prerequisites
| Tool | Version | Notes |
|------|---------|-------|
| Node | ≥ 18 LTS | `nvm install 18` |
| npm  | ≥ 10    | or `pnpm` if preferred |
| Supabase CLI | ≥ 1.160 | `brew install supabase/tap/supabase` |
| GitHub CLI (optional) | for repo bootstrapping |

### Clone & Install
```bash
git clone git@github.com:Netzoop/Ideazoop.git
cd Ideazoop
npm install        # 🔌 install deps
cp .env.local.example .env.local  # add your keys
```

### Environment Variables
| Var | Description |
|-----|-------------|
| `NEXT_PUBLIC_SUPABASE_URL` | Supabase project URL |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | Public anon key |
| `SUPABASE_SERVICE_ROLE_KEY` | **Server-side only** service role key |
| `OPENAI_API_KEY` | OpenAI key (sk-...) |
| `OPENAI_MODEL` | gpt-4o \| gpt-3.5-turbo |
| `OPENAI_DAILY_LIMIT` | API calls per day (default 5) |
| `NEXT_PUBLIC_SITE_URL` | Fully qualified URL for auth redirects |
| `VERCEL_URL` | Set by Vercel automatically in prod |

---

## Database & Supabase

### 1. Bootstrap Local Dev DB
```bash
supabase start         # launches local Postgres & Studio
npm run db:migrate     # applies SQL migrations
npm run db:types       # regenerates TypeScript types
```

### 2. Seed Admin User (optional)
Inside Supabase SQL editor (or `psql`):
```sql
select public.create_admin_user('admin@ideazoop.dev', 'StrongPassword!');
```

### 3. Push to Cloud
```bash
supabase db push --project-ref <project-id>
```

---

## Development Workflow

| Command | Purpose |
|---------|---------|
| `npm run dev` | Next.js dev server (Turbopack) |
| `npm run dev:all` | Next.js + Supabase local stack |
| `npm run lint` | ESLint (Next.js rules) |
| `npm run type-check` | TypeScript strict check |
| `npm test`, `test:watch` | Vitest unit tests |
| `npm run test:ui` | Interactive Vitest UI |
| `npm run test:coverage` | Coverage with v8 |
| `npm run format` | Prettier write |
| `npm run db:*` | DB lifecycle (migrate, types, seed, reset) |

Hot-reload works for RSC + client components; Supabase Realtime auto-reconnects on code changes.

---

## Quality & CI/CD

### Git Hooks
`husky` runs `validate` (lint + types + tests) pre-commit.

### GitHub Actions
`.github/workflows/ci.yml`
1. Install deps (cache)
2. `npm run validate`
3. Upload coverage
4. Deploy preview to Vercel on PRs

---

## Deployment (GitHub → Vercel)

1. **Create Vercel Project** – import the *Ideazoop* repo.<br>
   • Framework = Next.js • Root Dir = `/` • Build Cmd = `npm run vercel-build`<br>
   • Set env vars from `.env.local`.  
2. **Link Supabase** – allow domain in *Auth → URL Config*.  
3. **Merge to `main`** – GitHub Action triggers Vercel production deploy.  
4. **Supabase Config** – copy `SERVICE_ROLE_KEY` only to Vercel **server-only** env.

---

## Contributing
1. Fork → branch (`feat/xyz`)  
2. `npm run validate` (tests must pass)  
3. Open PR against `main` with a clear description.  
4. Maintainers review, run e2e, merge & deploy.

We follow Conventional Commits + semantic versioning.

---

## License
MIT © Netzoop 2024
